this is the new code to be merged with the main branch